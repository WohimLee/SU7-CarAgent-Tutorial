## QA 对挖掘
### 💡 一、QA 对挖掘是什么？

QA 对挖掘（Question-Answer Pair Mining）= 自动或半自动从数据中生成大量高质量的问答对。

它的主要用途：
- 训练 / 微调 LLM：用真实业务问题构建高价值数据集。
- 优化 RAG 系统：生成真实检索需求 → 检查召回效果 → 改进向量库。
- 提升 Agent 能力：让 Agent 在特定领域更懂问题、更能检索、更能规划行动。
- 用于评测 / Benchmark：制作符合业务的测试问题 + 标准答案

一句话总结：QA 对挖掘 = 让模型知道“别人会问什么”并提供“正确答案”，从而让系统变得更智能。

### 🎯 二、QA 对挖掘在 LLM / RAG / Agent 中分别起什么作用？
#### 2.1 在 LLM 中

>作用：

- 构造高质量训练数据
- 覆盖业务问题空间
- 增强模型对特定领域的理解能力

>例：

- 保险客服 LLM → 从保险条款中挖 QA
- 医疗系统 → 从指南中挖 QA

#### 2.2 在 RAG 中

>作用
- 用 QA 对反查向量库的召回效果
- 找出检索失败的“难例”
- 调优 chunk 方式、embedding、检索策略

>典型流程

- 生成问题
- 用 RAG 检索
- QA 对比（是否检索到能回答的问题的文档）
- 分析失败点并优化

#### 2.3 在 Agent 中

>作用

- 构建让 Agent 能执行的任务示例
- 增强 Agent 的“问题理解能力”
- 提供可学习的任务规划数据

>例
- “如何查找我上个月的支出并导出 Excel？”
→ Agent 用 QA 对学习如何调用工具实现任务。

### 🔧 三、怎么进行 QA 对挖掘？（实操步骤）

以下是业界常用流程，可用于企业知识库、API 文档、用户手册等任何资料源。

#### ✔️ 步骤 1：挖掘问题（Question Mining）
##### 方式 A：从文档中自动生成问题

提示模板示例：

请基于这段文档生成用户可能会问的实际问题，覆盖：
- 基本查询
- 操作步骤
- 注意事项
- 概念解释
- 场景化问题

##### 方式 B：从用户日志/客服记录挖问题

- 用户日志 → 高频问题
- 工单系统 → 真实需求句式
- 搜索日志 → 痛点需求

#### ✔️ 步骤 2：为问题生成标准答案（Answer Generation）

>常见方式：
- 让 LLM 基于原文抽取答案
- 保证答案可追溯
- 避免幻觉

>提示示例：
```
请严格从原文中抽取答案，不要补充外部知识。
```

#### ✔️ 步骤 3：过滤、清洗、规范化（QA Cleaning）

要处理的问题：

- 是否重复？
- 是否太模糊？
- 是否无法从文档回答？
- 答案是否包含幻觉？
- 是否符合预期风格？

常用技术：
- embedding 计算相似度去重
- LLM 做 consistency check
- 人工 Spot-check（抽查）

#### ✔️ 步骤 4：打标（Tagging / Metadata）

为每条 QA 增加：
- 来源文档 ID
- 难度分类
- 场景分类
- 是否可用于训练
- 是否可用于评测

#### ✔️ 步骤 5：使用 QA 对（用途）
##### 用于 LLM 微调
助于模型掌握特定领域知识

##### 用于 RAG 评估 & 优化

流程示例：
- 取 QA 中的问题
- 用 RAG 检索文档
- 判断答案是否能在检索文档中找到
- 得到指标：Recall、Precision、HitRate
- 优化 Chunk、Embedding、检索参数

##### 用于 Agent 训练

让 Agent 学会理解任务，并生成合理 action sequence

### 📌 四、QA 对挖掘的方法分类
#### （1）人工挖掘（最准确，但成本高）

- 专家基于文档编写 QA

#### （2）模型生成（自动化，高效率）
- 用 GPT-4+/Claude 等生成成千上万条 QA

#### （3）混合式最佳实践（推荐）

- 模型生成大部分
- 人工抽查关键部分

### 🧩 五、示例：RAG 中如何用 QA 诊断检索效果？

假设我们有 1 万条 QA。

评估步骤：

- 对每个 Q 执行向量检索 → 取 top-k 文档
- 检查其中是否包含 A 的证据文本
- 得到指标：Recall@k, MRR, Coverage
- 找到检索失败的 QA → 改进向量库和 chunk 策略

### 🌟 六、总结

QA 对挖掘 = 自动生成大量高质量问答，用于提升 LLM、RAG、Agent 的知识覆盖、检索效果和执行能力，是构建企业级智能系统的核心环节之一。